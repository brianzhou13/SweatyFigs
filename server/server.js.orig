var express = require('express');
var bodyParser = require('body-parser');
<<<<<<< 1acfff36e62a7f9865d07b6d7316a742fa48b3d0
var morgan = require('morgan');
var request = require('request');
var config = require('./env/config');
=======
var routes = require('./routes.js');

>>>>>>> connected server to routes

var app = express();

// middleware
app.use(bodyParser.json());
<<<<<<< 1acfff36e62a7f9865d07b6d7316a742fa48b3d0
app.use(morgan('dev'));
app.use('/', express.static('../client'));

// api/ingredients endpoint
app.get('/api/ingredients', function (req, res) {
  res.send(items);
});

/*
Calls spoonacular api to get recipes.

req.body has a property with an array of ingredients:

{
  "ingredients": [ "hotdogs", "flour", "milk" ]
}

*/
app.post('/api/recipes', function (req, res) {
  var ingredientsStr = req.body.ingredients.join('%2c+');
  request.get({ 
    headers: {
      'X-Mashape-Key': config.api_key
    },
    url: "https://spoonacular-recipe-food-nutrition-v1.p.mashape.com/recipes/findByIngredients?fillIngredients=false&ingredients=" + ingredientsStr+ "&limitLicense=false&number=5&ranking=1" }, 
    function(error, response, body) { 
    if (!error && response.statusCode == 200) { 
      res.send(body); 
    } 
  }); 
});

app.get('/', function (req, res) {
  res.send('Home Page');
});

=======

// implement routes
routes(app, express); // this should run the routes

// serve static assets
app.use(express.static(__dirname + '/../client'));


/**
simulate database

var items = [];

var addItem = function(item) {
  var itemObj = {};
  if (item) {
    itemObj._id = items.length;
    itemObj.name = item;
    items.push(itemObj);
  }
};

// add array of items
var addItems = function(food) {
  food.forEach(function(item) {
    addItem(item);
  });
};

addItems(['carrots', 'potatoes', 'rice']);
**/


>>>>>>> connected server to routes
app.listen(8080, function () {
  console.log('App listening on port 8080!');
});

// added in an exports.module line here
module.exports = app; // exporting app into routes
